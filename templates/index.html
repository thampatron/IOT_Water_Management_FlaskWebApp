{% extends "base.html" %}


{%block navbar%}
<div class="container" style="float:left; padding-bottom:9px; padding-bottom:5px;">
  
  <p>             
  <ul class="nav nav-tabs"  role="tablist">
    <li class="active"><a style="color:#00c6d1;" href="#">Water State</a></li>
    <li><a style="color:#00c6d1;" href="#">Node Network</a></li>
    <li><a style="color:#00c6d1;"href="#">Ground Temperature</a></li>
    <li><a style="color:#00c6d1;" href="#">Analytics</a></li>        
  </ul>
</div>
{%endblock%}

{%block style%}
<style>#map {
  height: 500px;  /* The height is 400 pixels */
  width: 100%;  /* The width is the width of the web page */
 }
</style>
{%endblock%}

{%block title%}
<h1 style="float:left; font-size:36px; padding-top:35px">IoT Water Stress Management System</h1>
{%endblock%}
{% block map %}
<div id="map"></div>
{% endblock %}

{% block script %}
{{super()}}


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>

{% endblock %}

{%block mapScript%}
<script>

    function initMap() {
      // The location of Uluru
      var uluru = {lat: -25.344, lng: 131.036};
      // The map, centered at Uluru
      var map = new google.maps.Map(
          document.getElementById('map'), {zoom: 4, center: uluru});
      // The marker, positioned at Uluru
      var marker = new google.maps.Marker({position: uluru, map: map});
      var contentStrin = '<progress  style="margin-top: 30px; line-width:600px; -webkit-transform: rotate(-90deg);" max=100 min=0value=45></progress>';
      var contentString ='<head><style>.progress-bar-vertical {width: 30px;min-height: 100px;margin-right: 20px;float: left;display: -webkit-box;  display: -webkit-flex; display: flex;         /* NEW, Spec - Firefox, Chrome, Opera */align-items: flex-end;-webkit-align-items: flex-end; /* Safari 7.0+ */}.progress-bar-vertical .progress-bar {width: 100%;height: 0;-webkit-transition: height 0.6s ease;-o-transition: height 0.6s ease;transition: height 0.6s ease;}</style></head><body><div style="width:150px;"><div class="progress progress-bar-vertical"><div class="progress-bar" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="height: 60%;"><span class="sr-only">60% Complete</span></div></div><h1>NodeID 4 <br /><br />Water State</h1></div></body>'
      var infowindow = new google.maps.InfoWindow({
          content: contentString
        });

        var marker = new google.maps.Marker({
          position: uluru,
          map: map,
          title: 'Uluru (Ayers Rock)'
        });
        marker.addListener('click', function() {
          infowindow.open(map, marker);
        });
    }
      </script> 

<script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDnJ9wRoBlPgi64Ny99kUDzw918x87cSms&callback=initMap">
    </script>
{%endblock%}


{%block chart%}
<script>
$(document).ready(function(){
        var text = 0;
        var date_settin = {{ date_settin }}.text;
        console.log(date_settin);
        switch(date_settin) {
            case "Last Day":
                text = 0;
                break;
            case "Last Month":
                text = 1;
                break;
            case "Last Year":
                text = 2;
                break;
            case "All Time":
                text = 3;
                break;
            default:
                text = 5;
            } 
            console.log(text);
            document.getElementById('dateSel').getElementsByTagName('option')[text].selected = 'selected';

        //document.getElementById('dataSel').options[text].selected = 'selected';
        }
    )
</script>
<form id="dateForm" method="POST" action="/changedate">
<select id="dateSel" name="date" onchange="$('#dateForm').submit()"; style=" margin-left:30px; margin-right:10px;margin-top:25px" >
        <option id="Day"  value="Day">Last Day</option>
        <option id="Month"value="Month">Last Month</option>
        <option id="Year" value="Year">Last Year</option>
        <option id="All"  value="All">All Time</option>   
        </select>
    </form>

<canvas id="myChart" width="400" height="90"></canvas>

<script>
    
        var labels = {{labels|tojson}};
        var data = {{data|tojson}};
        var ctx = document.getElementById('myChart').getContext('2d');
        var myChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: labels,
                datasets: [{
                    label: 'Soil Moisture Level',
                    data: data,
                    
                    borderWidth: 1
                },{
                    label: 'Too Wet',
                    backgroundColor: 'rgba(0, 100, 200, 0.2)',
                borderColor: 'rgba(255, 100, 200, 0.0)',

                },
                {
                    label: 'Optimal',
                    backgroundColor:'rgba(0, 100, 100,0.2)',
                borderColor: 'rgba(255, 100, 100, 0.0)',

                }
                ,{
                    label: 'Stress',
                    backgroundColor: 'rgba(255, 100, 200, 0.2)',
                borderColor: 'rgba(0, 100, 200, 0.0)',
                    
                }
            ]
            },
            options: {
                title: {
                display: false,
                text: 'Soil Moisture Levels'
                },
                scales: {
                    yAxes: [{
                        ticks: {
                            beginAtZero: true
                        }
                    }]
                },
                tooltips: {
                    mode: "index",
                    intersect: true
                },
            annotation: {
      
            annotations: [{
                drawTime: "afterDatasetsDraw",
                id: 'box1',
                type: 'box',
                yScaleID: 'y-axis-0',
                xScaleID: 'x-axis-0',
                mode: "horizontal",
                yMin: 0,
                yMax: 2,
                backgroundColor: 'rgba(255, 100, 200, 0.2)',
                borderColor: 'rgba(0, 100, 200, 0.0)',
                
                
            },{
                drawTime: "afterDatasetsDraw",
                id: 'box2',
                type: 'box',
                yScaleID: 'y-axis-0',
                xScaleID: 'x-axis-0',
                mode: "horizontal",
                yMin: 2,
                yMax: 6,
                backgroundColor: 'rgba(0, 100, 100,0.2)',
                borderColor: 'rgba(255, 100, 100, 0.0)',
                
            },{
                drawTime: "afterDatasetsDraw",
                id: 'box3',
                type: 'box',
                mode: "horizontal",
                yScaleID: 'y-axis-0',
                xScaleID: 'x-axis-0',
                yMin: 6,
                yMax: 8,
                backgroundColor: 'rgba(0, 100, 200, 0.2)',
                borderColor: 'rgba(255, 100, 200, 0.0)',
                
                
            }]
    }
        }});
        </script>
{%endblock%}